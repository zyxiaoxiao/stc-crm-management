import{u as A,r as v,a as m,o as Q,g as L,J as W,b,c as f,h as i,i as l,m as w,t as y,K as _,l as V,E as h,R as K}from"./index-93018481.js";import{h as $}from"./util-e879685f.js";import{z as j,_ as S}from"./ZDialog-43cdd841.js";import{_ as Z}from"./index-55024d44.js";import{_ as q}from"./company_list_select-ad2eb1d8.js";import{s as F,_ as G}from"./customer_distribution_detail-ff6c95ee.js";import"./_plugin-vue_export-helper-361d09b5.js";const X={class:"all-height flex-column main-card"},ne={__name:"companyInfo_list_distribution",setup(Y){const n=A(),x=[{type:"selection",width:"40"},{title:"\u72B6\u6001",label:"itemtitlecommondesc11",prop:"processflag",type:"workflowStatus",width:"70"},{title:"id",label:"companycorpidtitle",prop:"id",type:"id",width:"60",isHide:!0},{title:"\u5BA2\u6237\u53F7",label:"fieldcolumncustomercode",prop:"corpno",type:"Input",width:"160"},{title:"\u65E7\u5BA2\u6237\u53F7",label:"fieldcolumncustomercodeold",prop:"corpnoold",type:"Input",width:"160"},{title:"\u5BA2\u6237\u540D\u79F0",label:"panelcolumncustomername",prop:"corpdesc",type:"Input",width:"260"},{title:"\u9500\u552E\u4EBA\u5458/\u5BA2\u670D",label:"itemtitleSalesservice",prop:"salesmandesc",type:"Input",width:"160"},{title:"\u5F52\u5C5E\u5206\u516C\u53F8",label:"corpinfoSubordinateToBranchtitle",prop:"branchcorpdesc",type:"Input",width:"260"},{title:"\u5F52\u5C5E\u90E8\u95E8",label:"corpinfopaneldepartmentdesctitle",prop:"departmentdesc",type:"Input",width:"200"},{title:"\u521B\u5EFA\u4EBA",label:"corpinfopanelcjrtitle",prop:"recorderdesc",type:"Input",width:"160"},{title:"\u521B\u5EFA\u65F6\u95F4",label:"itemtitlestatusrecordertime",prop:"recordertime",type:"DateTime",width:"160"},{title:"\u64CD\u4F5C",label:"itemtitleloginoperation",prop:"operation",type:"operation",fixed:"right"},{title:"corpid",label:"",prop:"corpid",type:"Input",width:"160",isHide:!0},{title:"recordercode",label:"",prop:"recordercode",type:"Input",width:"160",isHide:!0},{title:"corpnofirst",label:"",prop:"corpnofirst",type:"Input",width:"160",isHide:!0},{title:"corpnolast",label:"",prop:"corpnolast",type:"Input",width:"160",isHide:!0}],d=v(),H=m({httpAttribute:{url:"/crm/distribution/distribution!selectDistributionInfoByCond.action",root:"distributionInfos",baseParams:{"cond.auditflag":"0"}},tableColumns:x,tableData:[]}),C=v(),B=m({httpAttribute:{url:"/crm/distribution/distribution!selectDistributionInfoByCond.action",root:"distributionInfos",baseParams:{"cond.auditflag":"1,2"}},tableColumns:[{type:"selection",width:"40"},{title:"\u72B6\u6001",label:"itemtitlecommondesc11",prop:"processflag",type:"workflowStatus",width:"70"},{title:"id",label:"companycorpidtitle",prop:"id",type:"id",width:"60",isHide:!0},{title:"\u5BA2\u6237\u53F7",label:"fieldcolumncustomercode",prop:"corpno",type:"Input",width:"160"},{title:"\u65E7\u5BA2\u6237\u53F7",label:"fieldcolumncustomercodeold",prop:"corpnoold",type:"Input",width:"160"},{title:"\u5BA2\u6237\u540D\u79F0",label:"panelcolumncustomername",prop:"corpdesc",type:"Link",width:"260"},{title:"\u9500\u552E\u4EBA\u5458/\u5BA2\u670D",label:"itemtitleSalesservice",prop:"salesmandesc",type:"Input",width:"160"},{title:"\u5F52\u5C5E\u5206\u516C\u53F8",label:"corpinfoSubordinateToBranchtitle",prop:"branchcorpdesc",type:"Input",width:"260"},{title:"\u5F52\u5C5E\u90E8\u95E8",label:"corpinfopaneldepartmentdesctitle",prop:"departmentdesc",type:"Input",width:"200"},{title:"\u521B\u5EFA\u4EBA",label:"corpinfopanelcjrtitle",prop:"recorderdesc",type:"Input",width:"160"},{title:"\u521B\u5EFA\u65F6\u95F4",label:"itemtitlestatusrecordertime",prop:"recordertime",type:"DateTime",width:"160"},{title:"corpid",label:"",prop:"corpid",type:"Input",width:"160",isHide:!0},{title:"recordercode",label:"",prop:"recordercode",type:"Input",width:"160",isHide:!0},{title:"corpnofirst",label:"",prop:"corpnofirst",type:"Input",width:"160",isHide:!0},{title:"corpnolast",label:"",prop:"corpnolast",type:"Input",width:"160",isHide:!0}],tableData:[]}),u=m({dialogShow:!1,codeid:"",tablename:"MLS_ENTERPRISE_DISTRIBUTION",columnid:"id"}),T=(e,t)=>{u.codeid=t[u.columnid],u.dialogShow=!0},r=m({dialogShow:!1,arrayList:[]}),E=()=>{r.arrayList=[],r.dialogShow=!0},O=async()=>{if(r.arrayList.length>0){console.log(r.arrayList);let e={corpids:r.arrayList},t={jsonString:JSON.stringify(e)};try{await $.post("/crm/distribution/distribution!saveDistributionInfos.action",V.stringify(t))&&(h.success(n.t("Message_OperationSuccess")),d.value.getTableList())}catch(s){let p=s.response.data.split("-");s.response.data.indexOf("There is a change in the data")>=0?h.warning(n.t("msg_bgfailure")+"\u53D8\u66F4\u4EBA\uFF1A"+p[0]):s.response.data.indexOf("There is a distrubution in the data")>=0?h.warning(n.t("msg_bgfailurefordistrubution")+"\u5206\u914D\u4EBA\uFF1A"+p[0]):s.response.data.indexOf("There are data in the application level")>=0&&h.warning(n.t("msg_bgfailureforlevel")+"\u7533\u8BF7\u4EBA\uFF1A"+p[0])}}},z=e=>{K.confirm(n.t("Message_Confirmdelete"),n.t("reminder"),{confirmButtonText:n.t("menu_ok"),cancelButtonText:n.t("menu_cancel"),type:"warning",draggable:!0}).then(async()=>{let t={distributionInfos:[]};e.forEach(I=>{t.distributionInfos.push({id:I})});let s={jsonString:JSON.stringify(t)};await $.post("/crm/distribution/distribution!deleteCrmaccountInfos.action",V.stringify(s))&&(h.success(n.t("Message_deleteSuccess")),d.value.getTableList())})},c=m({dialogShow:!1,ids:[],vShow:!0,success:!1}),M=e=>{c.dialogShow=!0,c.ids=e,c.success=!1},N=()=>{c.success&&d.value.getTableList()},a=m({dialogShow:!1,success:!1,readonly:!1,id:""}),U=e=>{a.dialogShow=!0,a.success=!1,a.id=e.id,a.readonly=!1},P=()=>{a.success&&d.value.getTableList()},R=(e,t)=>{a.dialogShow=!0,a.success=!1,a.id=t.id,a.readonly=!0},k=v("0"),J=e=>{switch(e){case"0":d.value.getTableList();break;case"1":C.value.getTableList();break}};return Q(()=>{d.value.getTableList()}),(e,t)=>{const s=L("el-button"),p=L("el-tab-pane"),I=L("el-tabs"),g=W("dialogStretching");return b(),f("div",X,[i(I,{class:"flex-column flex-1 main-card-tabs",modelValue:k.value,"onUpdate:modelValue":t[0]||(t[0]=o=>k.value=o),onTabChange:J},{default:l(()=>[i(p,{title1:"\u5BA2\u6237\u5206\u914D\u7533\u8BF7",label:e.$t("panelbaseapplicationDistributionOfCustomers"),class:"main-tab-pane-content all-height flex-column",name:"0"},{default:l(()=>[i(j,{ref_key:"zTable1",ref:d,tableList:H,onWorkflowStatus:T},{tableHeaderLleft:l(o=>[i(s,{size:"small",type:"primary",icon:"ZoomIn",plain:"",onClick:E},{default:l(()=>[w(y(e.$t("menu_choosebgcustomer")),1)]),_:1}),i(s,{size:"small",type:"danger",icon:"Delete",plain:"",disabled:!o.isSelected,onClick:D=>z(o.ids)},{default:l(()=>[w(y(e.$t("menu_delete")),1)]),_:2},1032,["disabled","onClick"]),i(s,{size:"small",type:"primary",icon:"Edit",plain:"",disabled:!o.isSelected,onClick:D=>M(o.ids)},{default:l(()=>[w(y(e.$t("menu_batchbg")),1)]),_:2},1032,["disabled","onClick"])]),operation:l(o=>[i(s,{type:"primary",link:"",icon:"Edit",onClick:D=>U(o.row)},{default:l(()=>[w(y(e.$t("menu_edit")),1)]),_:2},1032,["onClick"])]),_:1},8,["tableList"])]),_:1},8,["label"]),i(p,{title1:"\u5BA2\u6237\u5206\u914D\u7533\u8BF7\u67E5\u8BE2",label:e.$t("paneltitleapplicationDistributionOfCustomersQuery"),class:"main-tab-pane-content all-height flex-column",name:"1"},{default:l(()=>[i(j,{ref_key:"zTable2",ref:C,tableList:B,onWorkflowStatus:T,onLinkDetailbg:R},null,8,["tableList"])]),_:1},8,["label"])]),_:1},8,["modelValue"]),_((b(),f("div",null,[i(S,{modelValue:u.dialogShow,"onUpdate:modelValue":t[1]||(t[1]=o=>u.dialogShow=o),title:e.$t("menu_auditOpinion"),width:"95%"},{default:l(()=>[i(Z,{auditList:u},null,8,["auditList"])]),_:1},8,["modelValue","title"])])),[[g]]),_((b(),f("div",null,[i(S,{modelValue:r.dialogShow,"onUpdate:modelValue":t[2]||(t[2]=o=>r.dialogShow=o),title:e.$t("corpinfopanelckxxcxtitle"),width:"95%",onClose:O},{default:l(()=>[i(q,{condobj:r},null,8,["condobj"])]),_:1},8,["modelValue","title"])])),[[g]]),_((b(),f("div",null,[i(S,{modelValue:c.dialogShow,"onUpdate:modelValue":t[3]||(t[3]=o=>c.dialogShow=o),width:"85%",onClose:N,customclass:"selectbatchdeptanduserClass"},{default:l(()=>[i(F,{condobj:c},null,8,["condobj"])]),_:1},8,["modelValue"])])),[[g]]),_((b(),f("div",null,[i(S,{modelValue:a.dialogShow,"onUpdate:modelValue":t[4]||(t[4]=o=>a.dialogShow=o),width:"95%",onClose:P},{default:l(()=>[i(G,{condobj:a},null,8,["condobj"])]),_:1},8,["modelValue"])])),[[g]])])}}};export{ne as default};
