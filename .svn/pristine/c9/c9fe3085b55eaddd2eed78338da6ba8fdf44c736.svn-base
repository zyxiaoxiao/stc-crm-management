import{a as X,h as D}from"./util-e879685f.js";import{u as ee,r as M,a as C,w as ne,o as te,g as c,b as g,c as S,j as p,t as x,h as e,i as l,X as ie,K,P as oe,F as Z,D as G,I as Y,k as Q,Z as se,m as z,l as L,E as j,R as W,p as de,q as ue,J as pe}from"./index-93018481.js";import{z as re,_ as ae}from"./ZDialog-43cdd841.js";import{_ as ce}from"./_plugin-vue_export-helper-361d09b5.js";const le=v=>(de("data-v-2f613923"),v=v(),ue(),v),me={class:"all-height flex-row"},be={class:"filter main-card"},fe={class:"title sle"},_e={class:"flex-1 flex-column table-box"},ge={class:"main-card select-box"},he={class:"select-filter"},ye={class:"select-filter-item"},ve={class:"select-filter-list"},we={class:"select-filter-item"},ke=le(()=>p("div",{class:"select-filter-item-title"},[p("span",null," \u5F52\u5C5E\u7C7B\u578B \uFF1A")],-1)),Se={class:"select-filter-list"},Ce=le(()=>p("span",null,"SE\u5BA2\u6237",-1)),Ve=[Ce],Ie=le(()=>p("span",null,"\u90E8\u95E8\u5BA2\u6237",-1)),$e=[Ie],De={class:"main-card flex-1",style:{"margin-top":"10px",padding:"0px 15px"}},Le={__name:"select_batch_deptanduser",props:{condobj:Object},setup(v){const _=v,d=ee(),h=M(!1);h.value=_.condobj.vShow;const w=M(),T=M(""),N={children:"children",label:"corpdesc"},a=C([]);let k={headers:{noLoading:!0}};ne(T,t=>{w.value.filter(t)});const B=(t,s)=>t?s.corpdesc.includes(t):!0,y=async()=>{try{let t="{'cond.usercode':'admin','cond.parentid':0,'cond.rightflag':'false','cond.checked':false}";const s=await D.post("/core/corp/corp!selectForCorpManage.action",L.stringify(t),k);a.push(s[0])}finally{}},f=async t=>{i.httpAttribute.baseParams["cond.corpcode"]=t.corpcode,await A.value.reuseTableList()},m=C({brokerage:"1",brokeragelock:"0",checkox_commission:!1}),u=C(["SE"]),F=[{label:"0",value:"0"},{label:"1",value:"1"},{label:"3",value:"3"}],P=X("whether"),E=t=>{u.includes(t)||(u.push(t),u.splice(0,1),O(t))},O=t=>{i.httpAttribute.baseParams["cond.rolecode"]=t,A.value.reuseTableList()},A=M(),i=C({httpAttribute:{url:"/core/user/user!selectNOBGUserInfoByCorpid.action",root:"userInfos",baseParams:{"cond.islocal":"0","cond.rolecode":"SE"}},tableColumns:[{type:"selection",width:"40"},{title:"\u7528\u6237ID",label:"",prop:"userid",type:"id",width:"60",isHide:!0},{title:"\u7528\u6237\u7F16\u7801",label:"usergrouppanel_usercolumnusercodetitle",prop:"usercode",type:"Input",width:"160"},{title:"\u7528\u6237\u540D\u79F0",label:"columnUsernametitle",prop:"userdesc",type:"Input",width:"160"},{title:"\u5355\u4F4D\u7F16\u7801",label:"itemtitlegroupcorpcode",prop:"corpcode",type:"Input",width:"230"},{title:"\u6240\u5C5E\u5355\u4F4D",label:"itemtitlegroupcorpname",prop:"corpdesc",type:"Input",width:"160"},{title:"\u90AE\u7BB1",label:"personalusercolumnemailtitle",prop:"email",type:"Input",width:"200"},{title:"\u8054\u7CFB\u7535\u8BDD",label:"columnappointment_desc18",prop:"mobile",type:"Input",width:"200"},{title:"\u5907\u6CE8",label:"panelcolumnRemark",prop:"remark",type:"Input"}],tableData:[]}),o=(t,s)=>{if(u.includes("SE")&&t.length>1){j.warning(d.t("distribution_OnlyOneSE"));return}let b="";_.condobj.ids.forEach(I=>{b=b+I+","}),b=b.substring(0,b.length-1);const V={newcustomtype:u[0],corpcode:s[0].corpcode,edid:b};(m.checkox_commission||h.value===!1)&&(V.brokerage=h.value===!1&&u.includes("CSO")?"":m.brokerage,V.brokeragelock=m.brokeragelock);let U={jsonString:JSON.stringify({userids:t,cond:V})};W.confirm(d.t("Message_ConfirmOperation"),d.t("reminder"),{confirmButtonText:d.t("menu_ok"),cancelButtonText:d.t("menu_cancel"),type:"warning",draggable:!0}).then(async()=>{await D.post("/crm/distribution/distribution!saveDistributionUserAndCorp.action",L.stringify(U))&&(j({type:"success",message:d.t("Message_OperationSuccess")}),_.condobj.success=!0,_.condobj.dialogShow=!1)})};return te(()=>{y()}),(t,s)=>{const b=c("el-input"),V=c("el-tree"),U=c("el-scrollbar"),I=c("el-option"),J=c("el-select"),R=c("el-form-item"),$=c("el-col"),H=c("el-checkbox"),n=c("el-row"),q=c("el-button");return g(),S("div",me,[p("div",be,[p("h4",fe,x(t.$t("itemtitlebase_usercorpdesc")),1),e(b,{modelValue:T.value,"onUpdate:modelValue":s[0]||(s[0]=r=>T.value=r),placeholder:t.$t("enterKeywordsForFiltering"),formatter:r=>r.toUpperCase(),clearable:""},null,8,["modelValue","placeholder","formatter"]),e(U,{style:ie({height:"calc(100% - 95px)"})},{default:l(()=>[e(V,{ref_key:"treeRef",ref:w,"default-expand-all":"","node-key":"id",data:a,"highlight-current":!0,props:N,"filter-node-method":B,onNodeClick:f},null,8,["data"])]),_:1},8,["style"])]),p("div",_e,[p("div",ge,[p("div",he,[K(p("div",ye,[p("ul",ve,[e(n,{gutter:15,class:"main-align-items-center"},{default:l(()=>[e($,{span:8},{default:l(()=>[e(R,{title1:"\u63D0\u4F63\u70B9(%) \uFF1A",label:t.$t("itemtitlefoldersbrokerage")+" \uFF1A"},{default:l(()=>[e(J,{modelValue:m.brokerage,"onUpdate:modelValue":s[1]||(s[1]=r=>m.brokerage=r),class:"full-width-input",clearable:"",filterable:""},{default:l(()=>[(g(),S(Z,null,G(F,r=>e(I,{key:r.value,label:t.$t(r.label),value:r.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),e($,{span:8},{default:l(()=>[e(R,{title1:"\u4F63\u91D1\u70B9\u9501\u5B9A \uFF1A",label:t.$t("itemtitlefoldersbrokeragelock")+" \uFF1A"},{default:l(()=>[e(J,{modelValue:m.brokeragelock,"onUpdate:modelValue":s[2]||(s[2]=r=>m.brokeragelock=r),class:"full-width-input",clearable:"",filterable:""},{default:l(()=>[(g(!0),S(Z,null,G(Q(P),r=>(g(),Y(I,{key:r.value,label:t.$t(r.label),value:r.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),e($,{span:8},{default:l(()=>[e(R,{"label-width":20},{default:l(()=>[K(e(H,{title1:"\u6279\u91CF\u4FEE\u6539\u63D0\u4F63\u4FE1\u606F",modelValue:m.checkox_commission,"onUpdate:modelValue":s[3]||(s[3]=r=>m.checkox_commission=r),label:t.$t("messageshow_Batmodifyinformation"),border:""},null,8,["modelValue","label"]),[[oe,h.value]])]),_:1})]),_:1})]),_:1})])],512),[[oe,!(h.value==!1&&u[0]=="CSO")]]),p("div",we,[ke,e(U,null,{default:l(()=>[p("ul",Se,[p("li",{class:se({active:u.includes("SE")}),onClick:s[4]||(s[4]=r=>E("SE"))},Ve,2),p("li",{class:se({active:u.includes("CSO")}),onClick:s[5]||(s[5]=r=>E("CSO"))},$e,2)])]),_:1})])])]),p("div",De,[e(re,{ref_key:"zTable1",ref:A,tableList:i},{tableHeaderLleft:l(r=>[e(q,{size:"small",type:"primary",icon:"Finished",plain:"",disabled:!r.isSelected,onClick:Ee=>o(r.ids,r.selectList)},{default:l(()=>[z(x(t.$t("buttoncommonconfirm")),1)]),_:2},1032,["disabled","onClick"])]),_:1},8,["tableList"])])])])}}},je=ce(Le,[["__scopeId","data-v-2f613923"]]);const xe={class:"all-height flex-column"},Te={class:"filter main-card"},Oe={class:"title sle"},Ue={style:{"text-align":"right","margin-right":"10px"}},Me={__name:"selectDistributionCorpnew",props:{condobj:Object},setup(v){const _=v,d=ee(),h=M(),w=M(""),T={children:"children",label:"corpdesc"},N=C([]);let a={headers:{noLoading:!0}};ne(w,f=>{h.value.filter(f)});const k=(f,m)=>f?m.corpdesc.includes(f):!0,B=async()=>{try{let f="{'cond.usercode':'admin','cond.parentid':0,'cond.rightflag':'false','cond.checked':false}";const m=await D.post("/core/corp/corp!selectForCorpManage.action",L.stringify(f),a);N.push(m[0])}finally{}},y=()=>{let f=h.value.getCheckedNodes(!0,!1);if(f.length<=0){j.warning(d.t("Corp_selectMoreCorp"));return}_.condobj.arrayList=f,_.condobj.dialogShow=!1};return te(()=>{B()}),(f,m)=>{const u=c("el-input"),F=c("el-tree"),P=c("el-scrollbar"),E=c("el-button");return g(),S("div",xe,[p("div",Te,[p("h4",Oe,x(f.$t("itemtitlebase_usercorpdesc")),1),e(u,{modelValue:w.value,"onUpdate:modelValue":m[0]||(m[0]=O=>w.value=O),placeholder:f.$t("enterKeywordsForFiltering"),formatter:O=>O.toUpperCase(),clearable:""},null,8,["modelValue","placeholder","formatter"]),e(P,{style:ie({height:"calc(100% - 95px)"})},{default:l(()=>[e(F,{ref_key:"treeRef",ref:h,"show-checkbox":"","default-expand-all":"","node-key":"id",data:N,props:T,"filter-node-method":k},null,8,["data"])]),_:1},8,["style"])]),p("div",Ue,[e(E,{type:"primary",icon:"Finished",onClick:y},{default:l(()=>[z(x(f.$t("buttoncommonconfirm")),1)]),_:1})])])}}},Ne=ce(Me,[["__scopeId","data-v-9e54b48e"]]),Be={class:"all-height flex-column"},Re={__name:"customer_distribution_detail",props:{condobj:Object},setup(v){const _=v,d=ee(),h=X("crminvoice_format"),w=X("whether");let T=[{label:"tltilecolumndeptlevelbloc",value:"bloc"},{label:"tltilecolumndeptlevelbranch",value:"branch"},{label:"tltilecolumndeptlevelordinary",value:"ordinary"}],N=[{label:"i18nCustomerapplicationsecustomer",value:"SE"},{label:"itemtitlenewcustomtype0",value:"CSO"}];const a=C({id:_.condobj.id,corpid:""}),k=M(),B=C({tableToolbar:{whole:!_.condobj.readonly},httpAttribute:{url:"/core/user/user!selectBGUserInfo.action",root:"userInfoMaps",baseParams:{"cond.edid":a.id}},tableColumns:[{type:"selection",width:"40"},{title:"\u7528\u6237ID",label:"",prop:"userid",type:"id",width:"60",isHide:!0},{title:"\u4E3B\u8868id",label:"",prop:"edid",type:"Input",width:"60",isHide:!0},{title:"\u53D8\u66F4\u4F01\u4E1Aid",label:"",prop:"enterpriseid",type:"Input",width:"60",isHide:!0},{title:"\u5355\u4F4D\u7F16\u7801",label:"itemtitlegroupcorpcode",prop:"corpcode",type:"Input",width:"230"},{title:"\u6240\u5C5E\u5355\u4F4D",label:"itemtitlegroupcorpname",prop:"corpdesc",type:"Input",width:"160"},{title:"\u5F52\u5C5E\u7C7B\u578B",label:"itemtitleAttributiontype",prop:"newcustomtype",type:"Select",typeData:N,width:"160"},{title:"\u7528\u6237\u7F16\u7801",label:"usergrouppanel_usercolumnusercodetitle",prop:"usercode",type:"Input",width:"160"},{title:"\u7528\u6237\u540D\u79F0",label:"columnUsernametitle",prop:"userdesc",type:"Input",width:"160"},{title:"SE\u4F63\u91D1\u70B9",label:"itemtitlefoldersbrokerage",prop:"brokerage",type:"Input",width:"200"},{title:"\u4F63\u91D1\u70B9\u9501\u5B9A",label:"itemtitlefoldersbrokeragelock",prop:"brokeragelock",type:"Select",typeData:w,width:"160"},{title:"\u662F\u5426\u9501\u5B9A",label:"itemtitlebase_userlockflag",prop:"lockflag",type:"Select",typeData:w,width:"160"},{title:"\u5907\u6CE8",label:"panelcolumnRemark",prop:"remark",type:"Input"}],tableData:[]}),y=C({dialogShow:!1,arrayList:[]}),f=()=>{y.dialogShow=!0,y.arrayList=[]},m=async()=>{let i=y.arrayList;if(i.length>0){let o="";for(let t of i)o+="'"+t.corpcode+"',";if(o=o.substring(0,o.length-1),a.corpid&&a.id){let t={jsonString:JSON.stringify({cond:{corpcodes:o,corpid:a.corpid,edid:a.id,newcorp:"Y"}})};await D.post("/crm/distribution/distribution!saveDistributionUserAndCorp.action",L.stringify(t))&&(j({type:"success",message:d.t("Message_OperationSuccess")}),k.value.getTableList())}else{j.warning(d.t("Message_nofound"));return}}},u=C({dialogShow:!1,ids:[],vShow:!1,success:!1}),F=()=>{u.dialogShow=!0,u.ids=[a.id],u.success=!1},P=()=>{u.success&&k.value.getTableList()},E=i=>{for(let o of i)if(o.lockflag=="1"){j.warning(d.t("Message_NodeleteTheLockedData"));return}W.confirm(d.t("Message_Confirmdelete"),d.t("reminder"),{confirmButtonText:d.t("menu_ok"),cancelButtonText:d.t("menu_cancel"),type:"warning",draggable:!0}).then(async()=>{let o={jsonString:JSON.stringify({userInfoMaps:i})};await D.post("/crm/distribution/distribution!deleteDistributionUser.action",L.stringify(o))&&(j.success(d.t("Message_deleteSuccess")),k.value.getTableList())})},O=()=>{const i=[a];let o=!1,t=a.invoiceformat?a.invoiceformat:"0";for(let s of B.tableData)s.corpcode=="061155"&&(o=!0);W.confirm(d.t("Message_ConfirmOrNotSubmit"),d.t("reminder"),{confirmButtonText:d.t("menu_ok"),cancelButtonText:d.t("menu_cancel"),type:"warning",draggable:!0}).then(async()=>{let s=!0;if(o)try{const b=await D.post("/crm/distribution/distribution!updateDistributionByInvoiceformat.action",L.stringify({jsonString:JSON.stringify({cond:{id:a.id,invoiceformat:t}})}))}catch{s=!1}s&&await D.post("/crm/distribution/distribution!submitDistribution.action",L.stringify({jsonString:JSON.stringify({distributionInfos:i})}))&&(j.success(d.t("Message_OperationSuccess")),_.condobj.success=!0,_.condobj.dialogShow=!1)})},A=async()=>{let i={jsonString:JSON.stringify({distributionInfo:{id:a.id}})};const o=await D.post("/crm/distribution/distribution!selectDistributionInfoId.action",L.stringify(i));for(let t in o.distributionInfo[0])a[t]=o.distributionInfo[0][t]};return te(()=>{A(),k.value.getTableList()}),(i,o)=>{const t=c("el-input"),s=c("el-form-item"),b=c("el-col"),V=c("el-row"),U=c("el-option"),I=c("el-select"),J=c("el-form"),R=c("el-divider"),$=c("el-button"),H=pe("dialogStretching");return g(),S("div",Be,[e(J,{style:{margin:"15px 15px"},"label-position":"right","label-width":"120px",model:a,ref:"ruleFormRef"},{default:l(()=>[e(V,{gutter:15,class:"main-align-items-center"},{default:l(()=>[e(b,{span:6},{default:l(()=>[e(s,{title1:"\u5BA2\u6237\u53F7",label:i.$t("fieldcolumncustomercode")},{default:l(()=>[e(t,{type:"text",modelValue:a.corpno,"onUpdate:modelValue":o[0]||(o[0]=n=>a.corpno=n),modelModifiers:{trim:!0},readonly:""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(b,{span:6},{default:l(()=>[e(s,{title1:"\u5BA2\u6237\u540D\u79F0",label:i.$t("fieldcolumncustomername")},{default:l(()=>[e(t,{type:"text",modelValue:a.corpdesc,"onUpdate:modelValue":o[1]||(o[1]=n=>a.corpdesc=n),modelModifiers:{trim:!0},readonly:""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(b,{span:6},{default:l(()=>[e(s,{title1:"\u7535\u8BDD",label:i.$t("itemtitlebase_usertel")},{default:l(()=>[e(t,{type:"text",modelValue:a.corpphone,"onUpdate:modelValue":o[2]||(o[2]=n=>a.corpphone=n),modelModifiers:{trim:!0},readonly:""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(b,{span:6},{default:l(()=>[e(s,{title1:"\u7535\u5B50\u90AE\u4EF6",label:i.$t("corpinfopanelemailtitle")},{default:l(()=>[e(t,{type:"text",modelValue:a.corpemail,"onUpdate:modelValue":o[3]||(o[3]=n=>a.corpemail=n),readonly:""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),e(V,{gutter:15,class:"main-align-items-center"},{default:l(()=>[e(b,{span:6},{default:l(()=>[e(s,{title1:"\u5F52\u5C5E\u7EA7\u522B",label:i.$t("columnlevelattribution")},{default:l(()=>[e(I,{modelValue:a.deptlevel,"onUpdate:modelValue":o[4]||(o[4]=n=>a.deptlevel=n),class:"full-width-input",disabled:""},{default:l(()=>[(g(!0),S(Z,null,G(Q(T),n=>(g(),Y(U,{key:n.value,label:i.$t(n.label),value:n.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(b,{span:6},{default:l(()=>[e(s,{title1:"PKM \u5BA2\u6237\u533A\u57DF",label:i.$t("customerapplicationinvoice_format")},{default:l(()=>[e(I,{modelValue:a.invoiceformat,"onUpdate:modelValue":o[5]||(o[5]=n=>a.invoiceformat=n),class:"full-width-input",clearable:"",filterable:"",disabled:!!_.condobj.readonly},{default:l(()=>[(g(!0),S(Z,null,G(Q(h),n=>(g(),Y(U,{key:n.value,label:i.$t(n.label),value:n.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"]),e(R),e(re,{ref_key:"zTable1",ref:k,tableList:B},{tableHeaderLleft:l(n=>[e($,{size:"small",type:"primary",icon:"ZoomIn",plain:"",onClick:f},{default:l(()=>[z(x(i.$t("view_multiSelectDepartment")),1)]),_:1}),e($,{size:"small",type:"primary",icon:"ZoomIn",plain:"",onClick:F},{default:l(()=>[z(x(i.$t("menu_selectuser")),1)]),_:1}),e($,{size:"small",type:"danger",icon:"Delete",plain:"",disabled:!n.isSelected,onClick:q=>E(n.selectList)},{default:l(()=>[z(x(i.$t("menu_delete")),1)]),_:2},1032,["disabled","onClick"]),e($,{size:"small",type:"success",icon:"Select",plain:"",onClick:q=>O(n.selectList)},{default:l(()=>[z(x(i.$t("menu_submit")),1)]),_:2},1032,["onClick"])]),_:1},8,["tableList"]),K((g(),S("div",null,[e(ae,{modelValue:y.dialogShow,"onUpdate:modelValue":o[6]||(o[6]=n=>y.dialogShow=n),title:i.$t("corpinfopaneldepartmentdesctitle"),width:"40%",onClose:m},{default:l(()=>[e(Ne,{condobj:y},null,8,["condobj"])]),_:1},8,["modelValue","title"])])),[[H]]),K((g(),S("div",null,[e(ae,{modelValue:u.dialogShow,"onUpdate:modelValue":o[7]||(o[7]=n=>u.dialogShow=n),width:"85%",onClose:P,customclass:"selectbatchdeptanduserClass"},{default:l(()=>[e(je,{condobj:u},null,8,["condobj"])]),_:1},8,["modelValue"])])),[[H]])])}}};export{Re as _,je as s};
