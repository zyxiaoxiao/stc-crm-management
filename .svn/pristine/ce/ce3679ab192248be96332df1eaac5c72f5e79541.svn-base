import{a as O,h as g}from"./util-e879685f.js";import{u as x,r as R,a as _,g as c,J as T,b,c as y,j as E,h as e,i as t,m as V,t as w,F as J,D as z,I as H,k as K,K as Q,l as k,E as v}from"./index-93018481.js";import{d as W}from"./fileUtil-a1d39237.js";import{_ as G}from"./ZDialog-43cdd841.js";import{a as X}from"./customerfile_select-83e701c2.js";const Z={class:"all-height flex-column"},ee={style:{margin:"10px","text-align":"right"}},se={__name:"customer_account_new",props:{condobj:Object},setup(S){const s=S,p=x(),j=R(),l=_({accountid:s.condobj.accountid,corpid:s.condobj.corpid,accountno:"",accountcode:"",ismain:"0",accountbank:"",bankadress:"",swift:"",firstdealtime:"",fileid:"",filename:"",remark:"",modifypersoncode:"",modifypersondesc:"",recordercode:"",recorderdesc:"",recordtime:"",taxnumber:""}),C=_({accountno:[{required:!0,message:p.t("rulesPropMessage")}],accountcode:[{required:!0,message:p.t("rulesPropMessage")}],ismain:[{required:!0,message:p.t("rulesPropMessage")}],filename:[{required:!0,message:p.t("rulesPropMessage")}]}),F=O("whether");let M=!1,$=!1;(async()=>{(await g.post("/crm/account/crmaccount!selectMainCrmaccountInfoByCond.action",k.stringify({"cond.corpid":s.condobj.corpid}))).temp_crmaccountInfos.length>0&&(M=!0)})();const I=async()=>{let n={"cond.corpid":s.condobj.corpid,"cond.accountid":s.condobj.accountid};const a=await g.post("/crm/account/crmaccount!selectCrmaccountInfoByCond.action",k.stringify(n));for(let m in a.crmaccountInfos[0])Object.keys(l).includes(m)&&(l[m]=a.crmaccountInfos[0][m]);a.crmaccountInfos[0].ismain==1&&($=!0)};s.condobj.accountid&&I();const D=()=>{l.fileid&&l.filename&&W("/core/uploadnew/upload!download.action",l.filename,{"cond.crm":"crm","cond.fileid":l.fileid})},u=_({dialogShow:!1,corpid:s.condobj.corpid,arrayList:[]}),U=()=>{u.arrayList=[],u.dialogShow=!0},h=()=>{u.arrayList.length>0&&(l.fileid=u.arrayList[0].fileid,l.filename=u.arrayList[0].filename)},Y=n=>{!n||n.validate(async(a,m)=>{if(a){if(l.ismain==1&&M&&!$)return v.warning(p.t("Message_MainaccountUnique")),!1;let d={crmaccountInfos:[l]},i={"cond.corpid":s.condobj.corpid,jsonString:JSON.stringify(d)};await g.post("/crm/account/crmaccount!saveCrmaccountInfos.action",k.stringify(i))&&(v.success(p.t("Message_saveSuccess")),s.condobj.success=!0,s.condobj.dialogShow=!1)}else v.warning(p.t("rulesPropMessage2"))})};return(n,a)=>{const m=c("el-button"),d=c("el-input"),i=c("el-form-item"),r=c("el-col"),L=c("el-option"),q=c("el-select"),f=c("el-row"),B=c("el-date-picker"),N=c("el-button-group"),P=c("el-form"),A=T("dialogStretching");return b(),y("div",Z,[E("div",ee,[e(m,{size:"small",type:"primary",icon:"Document",plain:"",onClick:a[0]||(a[0]=o=>Y(j.value))},{default:t(()=>[V(w(n.$t("menu_save")),1)]),_:1})]),e(P,{model:l,rules:C,ref_key:"ruleFormRef",ref:j,"label-position":"right","label-width":"120px"},{default:t(()=>[e(f,{gutter:15,class:"main-align-items-center"},{default:t(()=>[e(r,{span:8},{default:t(()=>[e(i,{title1:"\u8D26\u6237\u53F7",label:n.$t("companypanelaccountnotitle"),prop:"accountno"},{default:t(()=>[e(d,{type:"text",clearable:"",modelValue:l.accountno,"onUpdate:modelValue":a[1]||(a[1]=o=>l.accountno=o),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(r,{span:8},{default:t(()=>[e(i,{title1:"\u8D26\u6237\u540D",label:n.$t("companypanelaccountnametitle"),prop:"accountcode"},{default:t(()=>[e(d,{type:"text",clearable:"",modelValue:l.accountcode,"onUpdate:modelValue":a[2]||(a[2]=o=>l.accountcode=o),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(r,{span:8},{default:t(()=>[e(i,{title1:"\u662F\u5426\u4E3A\u4E3B\u8D26\u6237",label:n.$t("companypanelOrNotMainAccounttitle"),prop:"ismain"},{default:t(()=>[e(q,{modelValue:l.ismain,"onUpdate:modelValue":a[3]||(a[3]=o=>l.ismain=o),class:"full-width-input",clearable:"",filterable:""},{default:t(()=>[(b(!0),y(J,null,z(K(F),o=>(b(),H(L,{key:o.value,label:o.label?n.$t(o.label):o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),e(f,{gutter:15,class:"main-align-items-center"},{default:t(()=>[e(r,{span:8},{default:t(()=>[e(i,{title1:"\u5F00\u6237\u884C",label:n.$t("companypanelaccountbanktitle")},{default:t(()=>[e(d,{type:"text",clearable:"",modelValue:l.accountbank,"onUpdate:modelValue":a[4]||(a[4]=o=>l.accountbank=o),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(r,{span:8},{default:t(()=>[e(i,{title1:"\u94F6\u884C\u5730\u5740",label:n.$t("companypanelbankadresstitle")},{default:t(()=>[e(d,{type:"text",clearable:"",modelValue:l.bankadress,"onUpdate:modelValue":a[5]||(a[5]=o=>l.bankadress=o)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(r,{span:8},{default:t(()=>[e(i,{title1:"SWIFT",label:n.$t("companypanelswifttitle")},{default:t(()=>[e(d,{type:"text",clearable:"",modelValue:l.swift,"onUpdate:modelValue":a[6]||(a[6]=o=>l.swift=o)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),e(f,{gutter:15,class:"main-align-items-center"},{default:t(()=>[e(r,{span:8},{default:t(()=>[e(i,{title1:"\u9996\u6B21\u4EA4\u6613\u65E5\u671F",prop:"address",label:n.$t("corpinfofirstTransactiondatetitle")},{default:t(()=>[e(B,{modelValue:l.firstdealtime,"onUpdate:modelValue":a[7]||(a[7]=o=>l.firstdealtime=o),type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(r,{span:12},{default:t(()=>[e(i,{title1:"\u6587\u6863\u540D\u79F0",label:n.$t("columnjxFileName"),prop:"filename"},{default:t(()=>[e(d,{type:"text",clearable:"",modelValue:l.filename,"onUpdate:modelValue":a[8]||(a[8]=o=>l.filename=o),readonly:""},{append:t(()=>[e(N,null,{default:t(()=>[e(m,{type:"primary",plain:"",icon:"View",onClick:D},{default:t(()=>[V(w(n.$t("messagecorelook")),1)]),_:1}),e(m,{type:"primary",plain:"",icon:"FolderChecked",onClick:U},{default:t(()=>[V(w(n.$t("qualificationDocumenttoSelectFile")),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),e(f,{gutter:15,class:"main-align-items-center"},{default:t(()=>[e(r,{span:24},{default:t(()=>[e(i,{title1:"\u5907\u6CE8\u4FE1\u606F",label:n.$t("panelcolumnRemark")},{default:t(()=>[e(d,{type:"textarea",clearable:"",modelValue:l.remark,"onUpdate:modelValue":a[9]||(a[9]=o=>l.remark=o)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model","rules"]),Q((b(),y("div",null,[e(G,{modelValue:u.dialogShow,"onUpdate:modelValue":a[10]||(a[10]=o=>u.dialogShow=o),title:n.$t("companypanel3CustomerQualificationFileInformationtitle"),width:"95%",onClose:h},{default:t(()=>[e(X,{condobj:u},null,8,["condobj"])]),_:1},8,["modelValue","title"])])),[[A]])])}}};export{se as _};
