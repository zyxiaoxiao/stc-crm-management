import{z as W,_ as pe}from"./ZDialog-43cdd841.js";import{r as g,a as M,o as X,b as w,c as V,h as e,u as fe,G as be,g as u,J as ye,j as _e,K as D,P as L,i as t,m,t as c,F as H,D as E,I as J,k as q,N as ge,l as U,E as z,R as we}from"./index-93018481.js";import{a as ve,h as I}from"./util-e879685f.js";import{h as G}from"./moment-da921422.js";import{d as K}from"./fileUtil-a1d39237.js";import{_ as Ve}from"./uploadAttachment-04d897fd.js";import{_ as ke}from"./_plugin-vue_export-helper-361d09b5.js";const $e={class:"all-height flex-column"},ze={__name:"select_results",props:{condobj:Object},setup(j){const _=j,p=g(),T=M({isPaging:!1,httpAttribute:{url:"/mylims/order/appointment!selectTestresultByFolderno.action",root:"vmaps",baseParams:{"cond.folderno":_.condobj.folderno}},tableColumns:[{type:"selection",width:"40"},{title:"testcode",label:"",prop:"testcode",type:"id",width:"60",isHide:!0},{title:"\u68C0\u6D4B\u9879\u76EE",label:"columnTestItems",prop:"testno",type:"Input"},{title:"\u68C0\u6D4B\u7ED3\u679C",label:"folderitemtitletestresult",prop:"result",type:"Input",width:"160"}],tableData:[]});return X(()=>{p.value.getTableList()}),(v,k)=>(w(),V("div",$e,[e(W,{ref_key:"zTable3",ref:p,tableList:T},null,8,["tableList"])]))}};const Se={class:"all-height flex-column"},De={style:{margin:"10px","text-align":"right"}},Ue={__name:"track_detail",props:{condobj:Object},setup(j){const _=j,p=fe(),T=be(),v=g(!0),k=g(!0),$=g(!0),F=g(),o=M({corpid:_.condobj.corpid,commid:_.condobj.commid,companyname:_.condobj.corpdesc,corpno:_.condobj.corpno,approvalstc:"",laboratoryfocus:"",pastyearcosts:0,cooperationlabs:"",commtime:"",commtype:"",commway:"",position:"",remindertime:"",commclient:"",followsituation:"",nextfollowup:"",informationSource:"",mainproducts:"",testproject:"",reocrdercode:"",recordercodetwo:"",recordertimetwo:""});o.commid||($.value=!1);const Q=ve("customer_informationsource"),Z=[{label:"corpinfopanelcontacttitle0",value:"0"},{label:"corpinfopanelcontacttitle1",value:"1"},{label:"corpinfopanelcontacttitle2",value:"2"},{label:"corpinfopanelcontacttitle3",value:"3"},{label:"corpinfopanelcontacttitle4",value:"4"}],ee=async()=>{let a={"cond.commid":o.commid};const l=await I.post("/mylims/trackinfo/track!selectTrackInfoById.action",U.stringify(a));C(l),Y()},te=a=>{!a||a.validate(async(l,d)=>{if(l){let f={trackInfo:o},r={jsonString:JSON.stringify(f),"cond.corpid":o.corpid};const i=await I.post("/mylims/trackinfo/track!saveTrackInfo.action",U.stringify(r));i&&(z.success(p.t("Message_saveSuccess")),_.condobj.success=!0,C(i),Y())}else z.warning(p.t("message_form_validation"))})},C=a=>{for(let l in a.trackInfo[0])Object.keys(o).includes(l)&&(l=="pastyearcosts"?o[l]=a.trackInfo[0][l]*1:o[l]=a.trackInfo[0][l])},Y=()=>{let a=G().format("YYYY-MM-DD"),l=G(new Date(o.recordertimetwo)).format("YYYY-MM-DD"),d=T.userInfo.usercode;o.reocrdercode==d&&a==l?(k.value=!0,v.value=!0):(v.value=!1,k.value=!1)},le=()=>{o.commid&&K("/mylims/trackinfo/track!trackDownloadWord.action","Track.doc",{commid:o.commid})},oe=()=>{P("/mylims/trackinfo/track!selectPreviousTrackInfo.action")},ae=()=>{P("/mylims/trackinfo/track!selectNextTrackInfo.action")},P=async a=>{if(o.commid){let l={commid:o.commid};const d=await I.post(a,U.stringify(l));C(d),Y()}},S=g(),B=M({isRequest:!0,tableToolbar:{right:!1},httpAttribute:{url:"/core/upload/upload!selectfilesInfoByCond.action",root:"fileInfos",baseParams:{"cond.reservnum":o.commid}},tableColumns:[{type:"selection",width:"40"},{title:"id",label:"id",prop:"fileid",type:"id",width:"60",isHide:!0},{title:"\u6587\u6863\u540D\u79F0",label:"columnjxFileName",prop:"filename",type:"Link"},{title:"\u6587\u6863\u5927\u5C0F",label:"companypanel3filesizetitle",prop:"filesize",type:"Input",width:"160"},{title:"\u6269\u5C55\u540D",label:"companypanel3extensiontitle",prop:"extension",type:"Input",width:"120"},{title:"\u4E0A\u4F20\u7528\u6237",label:"columnUploadUser",prop:"recorderdesc",type:"Input",width:"120"},{title:"\u4E0A\u4F20\u65F6\u95F4",label:"columnUploadTime",prop:"recordertime",type:"Input",width:"300"},{title:"mdmfileid",label:"",prop:"mdmfileid",type:"Input",width:"300",isHide:!0},{title:"businesstype",label:"",prop:"businesstype",type:"Input",width:"120",isHide:!0}],tableData:[]}),b=M({uploadUrl:"",uploadParameter:{},dialogShow:!1,success:!1}),ne=()=>{b.uploadUrl="http://localhost:3000/apis/core/uploadnew/upload!upload.action",b.uploadParameter={jsonString:"{uploadFile:{businesscode:'CRM/accessory', businessobjectid:'"+o.commid+"'}}","cond.commid":o.commid},b.success=!1,b.dialogShow=!0},ie=()=>{b.success&&S.value.getTableList()},se=(a,l)=>{K("/core/uploadnew/upload!download.action",l.filename,{"cond.crm":"crm","cond.fileid":l.fileid})},re=(a,l)=>{we.confirm(p.t("Message_Confirmdelete"),p.t("reminder"),{confirmButtonText:p.t("menu_ok"),cancelButtonText:p.t("menu_cancel"),type:"warning",draggable:!0}).then(async()=>{let d={fileInfos:[]};l.forEach(i=>{d.fileInfos.push({fileid:i.fileid,mdmfileid:i.mdmfileid})});let f={jsonString:JSON.stringify(d),"cond.crm":"crm"};await I.post("/core/uploadnew/upload!deleteUploadFileInfo.action",U.stringify(f))&&(z({type:"success",message:p.t("Message_deleteSuccess")}),S.value.getTableList())})},x=g(0),h=new Map([[1,!1]]),de=a=>{k.value&&(v.value=a==0),o.commid&&(B.httpAttribute.baseParams["cond.reservnum"]=o.commid,$.value=a==0,h.get(a)?S.value.reuseTableList():h.set(a,!0))};return X(()=>{o.commid&&ee()}),(a,l)=>{const d=u("el-button"),f=u("el-divider"),r=u("el-input"),i=u("el-form-item"),s=u("el-col"),y=u("el-row"),R=u("el-date-picker"),A=u("el-option"),N=u("el-select"),ue=u("el-form"),O=u("el-tab-pane"),me=u("el-tabs"),ce=ye("dialogStretching");return w(),V("div",Se,[_e("div",De,[D(e(d,{size:"small",type:"primary",icon:"Document",plain:"",onClick:l[0]||(l[0]=n=>te(F.value))},{default:t(()=>[m(c(a.$t("menu_save")),1)]),_:1},512),[[L,v.value]]),D(e(d,{size:"small",type:"info",icon:"ArrowLeft",plain:"",onClick:oe},{default:t(()=>[m(c(a.$t("SRM_btnPrevious")),1)]),_:1},512),[[L,$.value]]),D(e(d,{size:"small",type:"info",icon:"ArrowRight",plain:"",onClick:ae},{default:t(()=>[m(c(a.$t("SRM_btnNext")),1)]),_:1},512),[[L,$.value]]),e(d,{size:"small",type:"primary",icon:"Download",plain:"",onClick:le},{default:t(()=>[m(c(a.$t("SRM_btnDownload")),1)]),_:1})]),e(me,{class:"flex-column flex-1",style:{overflow:"auto"},modelValue:x.value,"onUpdate:modelValue":l[19]||(l[19]=n=>x.value=n),type:"border-card",onTabChange:de},{default:t(()=>[e(O,{title1:"\u8FFD\u8E2A\u8BB0\u5F55",label:a.$t("corpinfoTrackrecordtitle"),name:0},{default:t(()=>[e(ue,{style:{margin:"0px 15px"},"label-position":"right","label-width":"120px",model:o,ref_key:"ruleFormRef",ref:F},{default:t(()=>[e(f,{title1:"\u8FFD\u8E2A\u5BA2\u6237","content-position":"left"},{default:t(()=>[m(c(a.$t("corpinfoTrackcustomertitle")),1)]),_:1}),e(y,{gutter:15,class:"main-align-items-center"},{default:t(()=>[e(s,{span:6},{default:t(()=>[e(i,{title1:"\u5BA2\u6237\u540D\u79F0",label:a.$t("fieldcolumncustomername")},{default:t(()=>[e(r,{type:"text",modelValue:o.companyname,"onUpdate:modelValue":l[1]||(l[1]=n=>o.companyname=n),modelModifiers:{trim:!0},readonly:""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),e(f,{title1:"\u57FA\u672C\u60C5\u51B5","content-position":"left"},{default:t(()=>[m(c(a.$t("companyBasicsituationtitle")),1)]),_:1}),e(y,{gutter:15,class:"main-align-items-center"},{default:t(()=>[e(s,{span:6},{default:t(()=>[e(i,{title1:"\u5BF9STC\u8BA4\u53EF\u5EA6",label:a.$t("companyapprovalstctitle")},{default:t(()=>[e(r,{type:"text",modelValue:o.approvalstc,"onUpdate:modelValue":l[2]||(l[2]=n=>o.approvalstc=n),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(s,{span:6},{default:t(()=>[e(i,{title1:"\u9009\u62E9\u5B9E\u9A8C\u5BA4\u6700\u5173\u6CE8\u4EC0\u4E48",label:a.$t("companylaboratoryfocustitle")},{default:t(()=>[e(r,{type:"text",modelValue:o.laboratoryfocus,"onUpdate:modelValue":l[3]||(l[3]=n=>o.laboratoryfocus=n),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(s,{span:6},{default:t(()=>[e(i,{title1:"\u8FC7\u5F80\u4E00\u5E74\u7684\u68C0\u6D4B\u8D39\u7528",label:a.$t("companypastyearcoststitle"),prop:"pastyearcosts",rules:[{type:"number",message:a.$t("mustbeanumber")}]},{default:t(()=>[e(r,{type:"text",modelValue:o.pastyearcosts,"onUpdate:modelValue":l[4]||(l[4]=n=>o.pastyearcosts=n),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1},8,["label","rules"])]),_:1}),e(s,{span:6},{default:t(()=>[e(i,{title1:"\u4E0E\u5176\u4ED6\u5B9E\u9A8C\u5BA4\u7684\u5408\u4F5C\u60C5\u51B5",label:a.$t("companycooperationlabstitle")},{default:t(()=>[e(r,{type:"text",modelValue:o.cooperationlabs,"onUpdate:modelValue":l[5]||(l[5]=n=>o.cooperationlabs=n)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),e(f,{title1:"\u8DDF\u8E2A\u4FE1\u606F","content-position":"left"},{default:t(()=>[m(c(a.$t("corpinfoTrackinginformationtitle")),1)]),_:1}),e(y,{gutter:15,class:"main-align-items-center"},{default:t(()=>[e(s,{span:6},{default:t(()=>[e(i,{title1:"\u8054\u7CFB\u65F6\u95F4",label:a.$t("companyContactTimetitle")},{default:t(()=>[e(R,{modelValue:o.commtime,"onUpdate:modelValue":l[6]||(l[6]=n=>o.commtime=n),type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(s,{span:6},{default:t(()=>[e(i,{title1:"\u8054\u7CFB\u7C7B\u522B",label:a.$t("companyContactClasstitle")},{default:t(()=>[e(N,{modelValue:o.commtype,"onUpdate:modelValue":l[7]||(l[7]=n=>o.commtype=n),class:"full-width-input"},{default:t(()=>[(w(),V(H,null,E(Z,n=>e(A,{key:n.value,label:a.$t(n.label),value:n.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(s,{span:6},{default:t(()=>[e(i,{title1:"\u8054\u7CFB\u65B9\u5F0F",label:a.$t("corpinfopanelcontacttitle")},{default:t(()=>[e(r,{type:"text",modelValue:o.commway,"onUpdate:modelValue":l[8]||(l[8]=n=>o.commway=n)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(s,{span:6},{default:t(()=>[e(i,{title1:"\u804C\u4F4D",label:a.$t("companypositiontitle")},{default:t(()=>[e(r,{type:"text",modelValue:o.position,"onUpdate:modelValue":l[9]||(l[9]=n=>o.position=n)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),e(y,{gutter:15,class:"main-align-items-center"},{default:t(()=>[e(s,{span:6},{default:t(()=>[e(i,{title1:"\u4E0B\u6B21\u8DDF\u8FDB\u63D0\u9192\u65F6\u95F4",label:a.$t("columnremindertime")},{default:t(()=>[e(R,{modelValue:o.remindertime,"onUpdate:modelValue":l[10]||(l[10]=n=>o.remindertime=n),type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(s,{span:6},{default:t(()=>[e(i,{title1:"\u8054\u7CFB\u4EBA",label:a.$t("columnContactPerson")},{default:t(()=>[e(r,{type:"text",modelValue:o.commclient,"onUpdate:modelValue":l[11]||(l[11]=n=>o.commclient=n)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),e(y,{gutter:15,class:"main-align-items-center"},{default:t(()=>[e(s,{span:12},{default:t(()=>[e(i,{title1:"\u52A8\u6001\u8DDF\u8FDB\u60C5\u51B5",label:a.$t("companyfollowsituationtitle")},{default:t(()=>[e(r,{type:"textarea",modelValue:o.followsituation,"onUpdate:modelValue":l[12]||(l[12]=n=>o.followsituation=n)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(s,{span:12},{default:t(()=>[e(i,{title1:"\u8FDB\u4E00\u6B65\u8DDF\u8FDB\u65B9\u6CD5/\u52A8\u4F5C",label:a.$t("columncustomernextfollow")},{default:t(()=>[e(r,{type:"textarea",modelValue:o.nextfollowup,"onUpdate:modelValue":l[13]||(l[13]=n=>o.nextfollowup=n)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),e(f,{title1:"\u9879\u76EE\u4FE1\u606F","content-position":"left"},{default:t(()=>[m(c(a.$t("corpinfoProjectinformationtitle")),1)]),_:1}),e(y,{gutter:15,class:"main-align-items-center"},{default:t(()=>[e(s,{span:6},{default:t(()=>[e(i,{title1:"\u4FE1\u606F\u6765\u6E90",label:a.$t("companyinformationSourcetitle")},{default:t(()=>[e(N,{modelValue:o.informationSource,"onUpdate:modelValue":l[14]||(l[14]=n=>o.informationSource=n),class:"full-width-input"},{default:t(()=>[(w(!0),V(H,null,E(q(Q),n=>(w(),J(A,{key:n.value,label:a.$t(n.label),value:n.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),e(y,{gutter:15,class:"main-align-items-center"},{default:t(()=>[e(s,{span:12},{default:t(()=>[e(i,{title1:"\u4E3B\u8981\u4EA7\u54C1",label:a.$t("companymainproductstitle")},{default:t(()=>[e(r,{type:"textarea",modelValue:o.mainproducts,"onUpdate:modelValue":l[15]||(l[15]=n=>o.mainproducts=n)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(s,{span:12},{default:t(()=>[e(i,{title1:"\u6D4B\u8BD5\u9879\u76EE",label:a.$t("corpinfotestprojecttitle")},{default:t(()=>[e(r,{type:"textarea",modelValue:o.testproject,"onUpdate:modelValue":l[16]||(l[16]=n=>o.testproject=n)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),e(f,{title1:"\u8BB0\u5F55\u4EBA\u5458","content-position":"left"},{default:t(()=>[m(c(a.$t("companyrecordercodetwotitle")),1)]),_:1}),e(y,{gutter:15,class:"main-align-items-center"},{default:t(()=>[e(s,{span:6},{default:t(()=>[e(i,{title1:"\u8BB0\u5F55\u4EBA\u5458",label:a.$t("companyrecordercodetwotitle")},{default:t(()=>[e(r,{type:"text",modelValue:o.recordercodetwo,"onUpdate:modelValue":l[17]||(l[17]=n=>o.recordercodetwo=n),readonly:""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(s,{span:6},{default:t(()=>[e(i,{title1:"\u8BB0\u5F55\u65F6\u95F4",label:a.$t("companyrecordertimetwotitle")},{default:t(()=>[e(r,{type:"text",modelValue:o.recordertimetwo,"onUpdate:modelValue":l[18]||(l[18]=n=>o.recordertimetwo=n),readonly:""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["label"]),e(O,{title1:"\u9644\u4EF6\u4FE1\u606F",label:a.$t("columnAccessoryInformation"),class:"all-height flex-column main-tab-pane-content",name:1},{default:t(()=>[q(h).get(1)?(w(),J(W,{key:0,ref_key:"zTable1",ref:S,tableList:B,onLinkDetailbg:se},{tableHeaderLleft:t(n=>[e(d,{size:"small",type:"primary",icon:"UploadFilled",plain:"",onClick:ne},{default:t(()=>[m(c(a.$t("menu_upload")),1)]),_:1}),e(d,{size:"small",type:"danger",icon:"DeleteFilled",plain:"",disabled:!n.isSelected,onClick:Ie=>re(n.ids,n.selectList)},{default:t(()=>[m(c(a.$t("menu_deleteupload")),1)]),_:2},1032,["disabled","onClick"])]),_:1},8,["tableList"])):ge("",!0)]),_:1},8,["label"])]),_:1},8,["modelValue"]),D((w(),V("div",null,[e(pe,{modelValue:b.dialogShow,"onUpdate:modelValue":l[20]||(l[20]=n=>b.dialogShow=n),title:a.$t("UPLOAD_uploadFile"),width:"40%",customclass:"selectAgentCss",onClose:ie},{default:t(()=>[e(Ve,{condobj:b},null,8,["condobj"])]),_:1},8,["modelValue","title"])])),[[ce]])])}}},Fe=ke(Ue,[["__scopeId","data-v-392b1921"]]);export{ze as _,Fe as t};
